plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
A <- rs_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- rs_figB + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- B / plot_spacer() + plot_layout(heights = c(12, 1))
rs_row <- wrap_plots(A, B, ncol = 2, nrow = 1, widths = c(4, 1)) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
A <- rs_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- rs_figB + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- B / plot_spacer() + plot_layout(heights = c(12, 0.1))
rs_row <- wrap_plots(A, B, ncol = 2, nrow = 1, widths = c(4, 1)) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
B <- B / plot_spacer() + plot_layout(heights = c(50, 0.1))
A <- rs_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- rs_figB + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- B / plot_spacer() + plot_layout(heights = c(50, 0.1))
rs_row <- wrap_plots(A, B, ncol = 2, nrow = 1, widths = c(4, 1)) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
A <- rs_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- rs_figB + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- B / plot_spacer() + plot_layout(heights = c(50, 0.1))
rs_row <- wrap_plots(A, B, ncol = 2, nrow = 1, widths = c(4, 1)) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
svg("panel4.svg", width = 15.11, height = 6.59)
print(rs_row)
dev.off()
A <- rs_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- rs_figB + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- B / plot_spacer() + plot_layout(heights = c(50, 0.1))
rs_row <- wrap_plots(A, B, ncol = 2, nrow = 1, widths = c(3, 1)) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
svg("panel4.svg", width = 15.11, height = 6.59)
print(rs_row)
dev.off()
A <- rs_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- rs_figB + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- B / plot_spacer() + plot_layout(heights = c(50, 0.1))
rs_row <- wrap_plots(A, B, ncol = 2, nrow = 1, widths = c(2, 1)) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
svg("panel4.svg", width = 15.11, height = 6.59)
print(rs_row)
dev.off()
A <- rs_figA + theme(text = element_text(size = 28), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- rs_figB + theme(text = element_text(size = 28), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- B / plot_spacer() + plot_layout(heights = c(50, 0.1))
rs_row <- wrap_plots(A, B, ncol = 2, nrow = 1, widths = c(2, 1)) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
rs_row
svg("panel4.svg", width = 15.11, height = 6.59)
print(rs_row)
dev.off()
stu_row2
fs_f <- 30
A <- stu_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- stu_figB + theme(text = element_text(size = 30), plot.margin = unit(c(5.5, 5.5, 0, 5.5), "pt"))
C <- stu_figC + theme(text = element_text(size = 30), plot.margin = unit(c(5.5, 5.5, 0, 5.5), "pt"))
D <- stu_figD + theme(text = element_text(size = 30), plot.margin = unit(c(5.5, 5.5, 0, 5.5), "pt"))
E <- stu_figE + theme(text = element_text(size = 30), plot.margin = unit(c(5.5, 5.5, 0, 5.5), "pt"))
F <- stu_figF + theme(text = element_text(size = 30), plot.margin = unit(c(5.5, 5.5, 0, 5.5), "pt"))
saveRDS(stu_list, "stu_list.RDS")
stu_row2 <- wrap_plots(B, A, C, D, E, F, ncol = 2, nrow = 3) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 52, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
A
stu_figA_data <- readRDS('../../objective_2/analysis/plot_2_data.rds') %>%
ungroup() %>%
group_by(ID, period, exp_group) %>%
summarise(
l = mean(l),
e = mean(e)
) %>%
mutate(
period = recode(period, basal = "Base", experimental = "Exp")
)
stu_figA <- stu_figA_data %>%
ggplot(aes(period, l,
group = period,
color = exp_group,
#color= interaction(exp_group, period)
)) +
facet_wrap(~exp_group, strip.position = "bottom") +
geom_line(aes(group = ID), color = "gray") +
geom_boxplot(outlier.shape = NA, linewidth = 2, fill = NA) +
geom_point(size = 8, shape = 0) +
theme_pubr() +
theme(
text = element_text(size = fs),
legend.position = "none",
strip.text.x = element_blank(),
legend.title = element_blank(),
strip.background = element_blank()
) +
scale_color_manual(values = c("black", "#52AAD9"),
) +
ylab('Total # licks') +
xlab("") +
scale_y_continuous(breaks = seq(0, 2000, 1000),
expand = c(0,0)) +
coord_cartesian(ylim = c(0, 2000))
stu_figA
stu_figB_data <- readRDS('../../objective_2/analysis/plot_3_data') %>%
filter(exp_phase == 'experimental') %>%
ungroup() %>%
group_by(ID, exp_group, bins, n_sesion) %>%
summarise(
l = median(l)
) %>%
ungroup() %>%
group_by(ID, exp_group, bins) %>%
summarise(
l = median(l)
) %>%
mutate(
exp_group = recode(exp_group, control = "Control", experimental = "Uncertainty")
)
stu_figB <- stu_figB_data %>%
ggplot(aes(
as.numeric(bins), l, color = exp_group
)) +
geom_point(size = 8,
shape = 0) +
stat_summary(fun.data = "mean_cl_boot",
geom = 'line',
aes(group = exp_group),
linewidth = 1) +
stat_summary(fun.data = "mean_cl_boot",
geom = 'point',
aes(group = exp_group),
size = 8,
shape = 15) +
stat_summary(fun.data = mean_se, na.rm = TRUE,
geom = "errorbar", aes(group = exp_group), width = .2) +
theme_pubr() +
ylab('# licks') +
xlab('10 min intervals') +
scale_color_manual(values = c(ctrl, unc)) +
theme(
text = element_text(size = fs),
legend.position = 'none',
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_y_continuous(breaks = seq(0, 500, 250),
expand = c(0,0)) +
scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6),
expand = c(0, 0.6)) +
coord_cartesian(ylim = c(0, 500))
stu_figB
stu_figC_data <- readRDS('../../objective_2/analysis/plot_1_data.rds') %>%
ungroup() %>%
group_by(
ID, exp_group, period, group
) %>%
summarise(
l = mean(l),
e = mean(e)
) %>%
mutate(unc = if_else(group == "Expected", "No-uncertainty", "Uncertainty"))
stu_figC <- stu_figC_data %>%
ggplot(aes(group, l, color = unc)) +
geom_line(aes(group = ID), color = "gray") +
geom_boxplot(outlier.shape = NA, linewidth = 2, fill = NA,
position = position_dodge(width = 0)) +
geom_point(shape = 0, size = 8) +
theme_pubr() +
theme(legend.position = "none",
text = element_text(size = fs),
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_color_manual(values = c("gray70", unc, unc)) +
ylab('Average # licks') +
xlab("") +
scale_x_discrete(labels = c("Base", "100%", "50%")) +
scale_y_continuous(breaks = seq(0, 1000, 500),
expand = c(0,0)) +
coord_cartesian(ylim = c(0, 1000))
stu_figC
stu_figD_data <- readRDS('../../objective_2/analysis/plot_4_data.rds') %>%
ungroup() %>%
group_by(group, exp_phase, ID) %>%
summarise(
c = mean(n_clusters)
) %>%
mutate(
exp_phase = recode(exp_phase, basal = "Base", experimental = "Exp"),
group = recode(group, control = "Control", experimental = "Uncertainty"),
)
stu_figD <- stu_figD_data %>%
ggplot(aes(
exp_phase, c, color = group
)) +
facet_wrap(~group, strip.position = 'bottom') +
geom_line(aes(group = ID), color = "gray") +
geom_boxplot(outlier.shape = NA, linewidth = 2, fill = NA) +
geom_point(size = 8, position = position_dodge(0.9), shape = 0) +
theme_pubr() +
theme(legend.position = "none",
text = element_text(size = fs),
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_y_continuous(expand = c(0, 0),
breaks = seq(0, 200, 100),
) +
coord_cartesian(ylim = c(0, 200)) +
scale_color_manual(values = c('Control'="black", 'Uncertainty'= unc)) +
ylab('# of clusters') +
xlab("")
stu_figD
stu_figE_data <- readRDS('../../objective_2/analysis/plot_5_data.rds') %>%
ungroup() %>%
group_by(group, exp_phase, ID, n_sesion) %>%
summarise(
cnt = mean(cluster_length)
) %>%
ungroup() %>%
group_by(group, exp_phase, ID) %>%
summarise(
c = median(cnt)
) %>%
mutate(
exp_phase = recode(exp_phase, basal = "Base", experimental = "Exp"),
group = recode(group, control = "Control", experimental = "Uncertainty"),
)
stu_figE <- stu_figE_data %>%
ggplot(aes(
exp_phase, c, color = group
)) +
facet_wrap(~group, strip.position = 'bottom') +
geom_line(aes(group = ID), color = "gray") +
geom_boxplot(outlier.shape = NA, linewidth = 2, fill = NA) +
geom_point(size = 8, position = position_dodge(0.9), shape = 0) +
theme_pubr() +
theme(legend.position = "none",
text = element_text(size = fs),
strip.text.x = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_y_continuous(expand = c(0, 0),
breaks = seq(0, 20, 10),
) +
coord_cartesian(ylim = c(0, 20)) +
scale_color_manual(values = c('Control'="black", 'Uncertainty'= unc)) +
ylab('Cluster size') +
xlab("")
stu_figE
mdl_figE <- lmer(
data = stu_figE_data,
c ~ group * exp_phase + (1 | ID)
)
summary(mdl_figE)
stu_figF_data <- read_csv("~/repos_sync/PHD_data/objective_2/data/weights_objective_2.csv") %>%
mutate(init_end = if_else(`date-ymd` == "2022-08-08", "Base", "Exp")) %>%
group_by(ID, group, init_end) %>%
summarise(
w = median(weight)
)
stu_figF <- stu_figF_data %>%
ggplot(aes(
init_end, w, group = ID, color = group
)) +
geom_line(
color = "gray"
) +
geom_boxplot(outlier.shape = NA, linewidth = 2, aes(group = interaction(init_end, group)), fill = NA) +
geom_point(
shape = 0,
size = 8
) +
facet_wrap(~group, strip.position = 'bottom') +
theme_pubr() +
theme(legend.position = "none",
text = element_text(size = fs),
strip.text.x = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_y_continuous(expand = c(0, 0),
breaks = seq(20, 30, 5),
) +
coord_cartesian(ylim = c(20, 30)) +
scale_color_manual(values = c('Control'="black", 'Uncertainty'= unc)) +
ylab('Wt (gr)') +
xlab("")
stu_figF
fs_f <- 30
A <- stu_figA + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- stu_figB + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
C <- stu_figC + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
D <- stu_figD + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
E <- stu_figE + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
F <- stu_figF + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
stu_row2 <- wrap_plots(B, A, C, D, E, F, ncol = 2, nrow = 3) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 52, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
stu_row2
stu_row2 <- wrap_plots(B, A, C, D, E, F, ncol = 2, nrow = 3) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
svg("panel3.svg", width = 15.11, height = 6.59)
print(stu_row2)
dev.off()
stu_row2
stu_row2 <- wrap_plots(B, A, C, D, E, F, ncol = 2, nrow = 3) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
svg("panel0.svg", width = 15.11, height = 6.59)
print(stu_row2)
dev.off()
stu_row2 <- wrap_plots(B, A, C, D, E, F, ncol = 2, nrow = 3) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
svg("panel0.svg", width = 15.11, height = 11.83)
print(stu_row2)
dev.off()
stu_row2 <- wrap_plots(B, A, C, D, E, F, ncol = 2, nrow = 3) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'),
plot.margin=unit(c(0,0,0,0), "pt")
)
svg("panel0.svg", width = 20, height = 11.83)
print(stu_row2)
dev.off()
A <- ltu_figF + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- ltu_figG + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
C <- ltu_figH + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
D <- ltu_figI + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
E <- ltu_figJ + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
aa <- (A | B) / C
bb <- D / E
ltu_row2 <- wrap_plots(aa, bb, ncol = 2, nrow = 1) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'))
svg("panel3.svg", width = 15.11, height = 6.59)
print(ltu_row2)
dev.off()
ltu_figI <- ltu_figI_data[[1]] %>%
ggplot(aes(
group, value*10000, color = group
)) +
geom_boxplot(outlier.shape = NA, linewidth = 2) +
geom_point(
shape = 0,
size = 8
) +
ylab("Î± est x 10^4") +
xlab("") +
theme_pubr() +
theme(legend.position = "none",
text = element_text(size = fs),
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_y_continuous(expand = c(0, 0),
breaks = seq(0, 15, 5),
) +
coord_cartesian(ylim = c(0, 15)) +
scale_color_manual(values = c('No-Uncertainty'="black", 'Uncertainty'= unc)) +
scale_x_discrete(labels = c("Cer", "Unc"))
ltu_figI
ltu_figJ <- ltu_figI_data[[2]] %>%
ggplot(aes(
group, value, color = group
)) +
geom_boxplot(outlier.shape = NA, linewidth = 2) +
geom_point(
shape = 0,
size = 8
) +
ylab("Q0 estimate") +
xlab("") +
theme_pubr() +
theme(legend.position = "none",
text = element_text(size = fs),
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_y_continuous(expand = c(0, 0),
breaks = seq(0, 30, 7.5),
) +
coord_cartesian(ylim = c(0, 30)) +
scale_color_manual(values = c('No-Uncertainty'="black", 'Uncertainty'= unc)) +
scale_x_discrete(labels = c("Cer", "Unc"))
ltu_figJ <- ltu_figI_data[[2]] %>%
ggplot(aes(
group, value, color = group
)) +
geom_boxplot(outlier.shape = NA, linewidth = 2) +
geom_point(
shape = 0,
size = 8
) +
ylab("Q0 est") +
xlab("") +
theme_pubr() +
theme(legend.position = "none",
text = element_text(size = fs),
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.title = element_blank(),
plot.margin = margin(
t = t,
b = b,
r = r,
l = l
)
) +
scale_y_continuous(expand = c(0, 0),
breaks = seq(0, 30, 7.5),
) +
coord_cartesian(ylim = c(0, 30)) +
scale_color_manual(values = c('No-Uncertainty'="black", 'Uncertainty'= unc)) +
scale_x_discrete(labels = c("Cer", "Unc"))
ltu_figJ
A <- ltu_figF + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
B <- ltu_figG + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
C <- ltu_figH + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
D <- ltu_figI + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
E <- ltu_figJ + theme(text = element_text(size = 30), plot.margin = unit(c(0, 0, 0, 0), "pt"))
aa <- (A | B) / C
bb <- D / E
ltu_row2 <- wrap_plots(aa, bb, ncol = 2, nrow = 1) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 32, face = 'bold'))
svg("panel3.svg", width = 15.11, height = 6.59)
print(ltu_row2)
dev.off()
